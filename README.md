# ENAS_ELM_RUL
Architecture Search for Extreme Learning Machine with Evolutionary Algorithms. <br/>
- Generate(slice) fixed length sequence from timse series. <br/>
- Apply dimensionality reduction method (optional). <br/>
- Run neural architecture search for MLPs <br/>
- Design an ELM and run neural architecture search for the ELM  <br/>
- Evaluate and compare the two methods.

## Prerequisites
You can download the benchmark dataset used in our experiments, C-MAPSS from [here](https://drive.google.com/drive/folders/1xHLtx9laqSTO_8LOFCdOBEkouMpbkAFM?usp=sharing).
The files should be placed in /cmapss folder.
The library has the following dependencies:
```bash
pip3 install -r requirements.txt
```
-pandas <br/>
-numpy <br/>
-matplotlib <br/>
-seaborn <br/>
-sklearn <br/>
-pyts <br/>
-scikit-learn <br/>
-tensorflow-gpu <br/>
-pathos <br/>
-autokeras <br/>

## Descriptions
- main.py: launcher for the experiments.
  - input_creator.py
  - network.py
  - ea.py
  - task.py

## Run
Please launch the experiments by 
```bash
python3 main.py -i dataset -l sequence_legnth --method dim_reduction --pop populations --gen generations
```

&ndash;  i : input subdataset (1 for FD001... 4 for FD004) <br/>
&ndash;  l : sequence length of time series <br/>
--method : default='non', help='method for dim.reduction methods 'non','sfa' or 'pca'' <br/>
--epochs : default=1000, help='number epochs for network training' <br/>
--batch : default=700, help='batch size of BPTT training' <br/>
--pop : default=50, help='popluation size for EA' <br/>
--gen : default=50, help='max generations for EA' <br/>

Genotype for each method.
- non: [n_hidden1, n_hidden2]
- pca: [n_components, n_hidden1, n_hidden2]
- sfa: [n_components, n_bins, n_hidden1, n_hidden2]


You can check all the other arguments and their details by
```bash
python3 main.py -h
```

For example,
```bash
python3 main.py -i 1 -l 30 --method pca --epochs 300 --pop 20 --gen 20
```

After running the code, all EA related log are saved into a file in EA_log folder, and  <br/>
you will get the results of the discovered NN architecture in RMSE & Score on test data. <br/>




## Results
Time series of the first engine (generated by run to faulure simulation) in training set
![](/figures/r2f_ts.png)

Sliced time series with fixed length (so called sequence) right before the engine failure
![](/figures/sequences.png)

EA log  <br/>
![](/figures/ea_log.png)



Plot of training and validation loss of the discovered network 
![](/figures/loss.png)

Prediction & ground truth of RUL
![](/figures/results.png)

